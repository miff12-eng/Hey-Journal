workflows:
ios-capacitor:
  name: iOS Capacitor Build
  environment:
    node: latest
    xcode: latest
    cocoapods: default
  scripts:
    - name: Install Node.js dependencies
      script: npm install
    - name: Build web app
      script: npm run build
    - name: Sync with Capacitor
      script: npx cap sync ios
    - name: Install CocoaPods
      script: |
        cd ios/App
        pod install
  artifacts:
    - ios/App/build/ios/ipa/*.ipa
  publishing:
    app_store_connect:
      api_key: $APP_STORE_CONNECT_KEY
      key_id: $APP_STORE_CONNECT_KEY_ID
      issuer_id: $APP_STORE_CONNECT_ISSUER_ID